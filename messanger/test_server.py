import server
import unittest
from socket import *

class TestClient(unittest.TestCase):
    
    def test_upmes(self):
        ms = b'\x80\x04\x95z\x00\x00\x00\x00\x00\x00\x00}\x94(\x8c\x06action\x94\x8c\x08presence\x94\x8c\x04time\x94\x8c\x10<unix timestamp>\x94\x8c\x04type\x94\x8c\x06status\x94\x8c\x04user\x94}\x94(\x8c\x0caccount_name\x94\x8c\x06AlexSu\x94h\x06\x8c\x0fYep, I am here!\x94uu.'
        self.assertEqual(server.upload_message(ms), {'action': 'presence', 'time': '<unix timestamp>', 'type': 'status', 'user': {'account_name': 'AlexSu', 'status': 'Yep, I am here!'}})
    
    def test_sendmes(self):
        mc = {
            "response": 200,
            "alert":"Необязательное сообщение/уведомление"
        }
        self.assertEqual(server.form_mes(mc), b'\x80\x04\x95c\x00\x00\x00\x00\x00\x00\x00}\x94(\x8c\x08response\x94K\xc8\x8c\x05alert\x94\x8cF\xd0\x9d\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x81\xd0\xbe\xd0\xbe\xd0\xb1\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5/\xd1\x83\xd0\xb2\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xbc\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5\x94u.'
